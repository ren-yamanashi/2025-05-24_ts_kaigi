---
layout: default
---

<style scoped>
.slidev-vclick-hidden {
  display: none;
}
</style>

<div class="_bullet">

#### 2. 型情報を辿って、インスタンス化されたクラスが `Construct` クラスを継承しているかを判定

- typescript の [`getBaseType`](https://github.com/microsoft/TypeScript/blob/v5.8.2/src/compiler/checker.ts#12615) 関数を再起的に実行し `Construct` を継承しているか判定

```ts{*}
const service = ESLintUtils.getParserServices(context);
const typeChecker = service.program.getTypeChecker();

return {
  NewExpression(node) {
    const nodeType = typeChecker.getTypeAtLocation(node);

    // インスタンス化したクラスの型情報
    const isExtendedConstruct = (type?: Type): boolean => {
      const baseTypes = type?.getBaseTypes() ?? [];
      if (type?.symbol?.name === "Construct") return true;
      return baseTypes.some((baseType) => isExtendedConstruct(baseType));
    };

    if (!isExtendedConstruct(nodeType)) return;
```

</div>
