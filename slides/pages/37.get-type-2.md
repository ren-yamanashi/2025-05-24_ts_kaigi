---
layout: default
---

<style scoped>
.slidev-vclick-hidden {
  display: none;
}
</style>

<div class="_bullet">

2. 末尾が`Error`の場合、AST から型情報を取得

* `parserServices.getTypeAtLocation`
  * `typescript-eslint` の AST (`TSESTree.Node`)を受け取り 型情報(`ts.Type`)を返す

<div v-click="[0]" class="mt-35" />

<div class="_bullet" v-click="1">

* 内部的には `TSESTree.Node` を `ts.Node` に変換し `ts.getTypeAtLocation` を呼び出す
  * 参考: https://github.com/typescript-eslint/typescript-eslint/blob/v8.31.0/packages/typescript-estree/src/createParserServices.ts#L35-L36

</div>

```ts{4,8}
export const requireExtendsError = ESLintUtils.RuleCreator.withoutDocs({
   // ...
  create(context) {
    const parserServices = ESLintUtils.getParserServices(context);
    return {
      ClassDeclaration(node) {
        if (!node.id?.name.endsWith("Error")) return;
        const nodeType = parserServices.getTypeAtLocation(node);
      },
```

</div>

<!-- 
この関数は`typescript-eslint`のAST Node を受け取り、型情報を返す関数です。  

[click] この関数では内部的に、`typescript-eslint`の AST Node を TypeScript の AST Node に変換し、TypeScript の`getTypeAtLocation`つまり先ほど紹介した、TypeScript の AST Node を受け取り型情報を取得する関数を呼び出しています。

ここまでで、AST から型情報を取得する実装が完了したので、
-->