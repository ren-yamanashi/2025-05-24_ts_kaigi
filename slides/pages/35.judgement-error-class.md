---
layout: default
---

<style scoped>
.slidev-vclick-hidden {
  display: none;
}
</style>

<div class="_bullet">

1. 定義されたクラス名の末尾が`Error`かを判定

<div v-click="1" v-click.hide="3">

* クラスが定義するコードから、どのような AST が生成するかを把握

</div>

<div class="small-code-json" v-click="[2]">

```json{*}
// class NotExistsError {}
{
  "type": "Program",
  "body": [
    {
      "type": "ClassDeclaration",
      "id": {
        "type": "Identifier",
        "name": "SampleError"
      },
      "body": {
        "type": "NotExistsError",
        "body": []
      }
    }
  ]
}
```

</div>

</div>

<div v-click="3" class="_bullet">

* ClassDeclarations の`id`プロパティの`name`をもとに判定

```ts{*}
import { ESLintUtils } from "@typescript-eslint/utils";
import { SymbolFlags, Type } from "typescript";

export const requireExtendsError = ESLintUtils.RuleCreator.withoutDocs({
  meta: {
    // ...
  },
  create(context) {
    const parserServices = ESLintUtils.getParserServices(context);
    return {
      ClassDeclaration(node) {
        if (!node.id?.name.endsWith("Error")) return;
      },
    };
  },
});
```

</div>

<!-- 
ではさっそく、定義されたクラス名の末尾が`Error`かを判定する実装を行います。  

[click] この実装を行うには、クラスを定義するコードから、どのような AST が生成するかを把握したいので、`NotExistsError`という名前のクラスを定義した時の AST を見てみます。

[click] 表示されているものは AST をかなり単純化したものですが、ClassDeclarations の`id`プロパティの`name`に、クラス名が格納されていることがわかります。  
そのため、クラス名の末尾が`Error`になっているかを判断するコードをこのように実装します

[click] 今回定義するルールは、Class定義のノードに対する操作を行いたいので、`create`メソッドの`return`に`ClassDeclaration`を指定しています。  
これにより、eslint が `ClassDeclaration` のノードを探索する際に、記述した処理が実行されます。

ASTの内容をもとに、ClassDeclarationのidプロパティのnameの末尾が`Error`であるかを判定しています
-->