---
layout: default
transition: none
---

<style scoped>
.slidev-vclick-hidden {
  display: none;
}
</style>

<div class="_bullet">

2. 末尾が`Error`の場合、AST から型情報を取得

<div v-click="1">

* <span v-mark="{at: 2, color: 'red'}">AST</span> から型情報を取得する際には、typescript の `getTypeAtLocation` 関数を使用
  * `typescript` の AST Node (`ts.Node`) を受け取り、型情報 (`ts.Type`) を返す

<div v-click="[1]" class="mt-20.5" />

<div v-click="2">

※ `typescript` の AST Node (`ts.Node`) であり、`typescript-eslint` の AST Node (`TSESTree.Node`) ではない  

</div>

```ts
// 参照: https://github.com/microsoft/TypeScript/blob/v5.8.3/src/compiler/types.ts#L5160
export interface TypeChecker {
  // ...
  getTypeAtLocation(node: Node): Type;
}
```

</div>

<br />

<div class="text-center" v-click="3">

`TSESTree.Node` から `ts.Type` を取得するには `typescript-eslint` の `getTypeAtLocation` を使用

</div>

</div>

<!-- 
続いて、AST から型情報を取得する実装を行います。

[click] AST から型情報を取得する際には、typescript の `getTypeAtLocation` という関数を使用します。

この関数は、TypeScript の AST ノードを受け取ると、型情報を返す関数です  
つまり、この `getTypeAtLocation` を呼び出すことで、AST から 型情報を取得できるといった感じになります。

[click] ただ、ここで注意したいのは、`getTypeAtLocation`が受け取る AST ノードは、TypeScript の世界の AST ノードであり、`typescript-eslint`が生成する AST ノードではないということです。  
そのため、`typescript-eslint`が生成する AST を`typescript`の AST に変換し、それを`getTypeAtLocation`関数に渡す必要があります

[click] そこで、`typescript-eslint`から提供される、`getTypeAtLocation`を使用します。  
-->